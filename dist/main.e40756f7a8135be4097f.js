(()=>{"use strict";(()=>{const t=document.getElementById("canvas");let e=100,o=100,l=0,n=0,c=0;const a=64,h=[1,1,1,1,1,1,1,1,1,0,0,0,1,0,0,1,1,0,1,0,1,0,0,1,1,0,1,0,1,0,0,1,1,0,1,0,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,0,1,1,1,1,1,1,1,1,1],s=()=>{for(let e=0;e<8;e++)for(let o=0;o<8;o++){const l=t.getContext("2d");l.fillStyle=1===h[8*o+e]?"#ffffff":"#000000";const n=e*a,c=o*a,s=n+a,f=c,i=n+a,M=c+a,d=n,r=c+a;l.beginPath(),l.moveTo(n+1,c+1),l.lineTo(s-1,f+1),l.lineTo(i-1,M-1),l.lineTo(d+1,r-1),l.closePath(),l.fill()}},f=(t,e,o,l)=>Math.sqrt((o-t)**2+(l-e)**2);s(),(()=>{const a=t.getContext("2d");a.fillStyle="yellow";a.fillRect(e,o,8,8);const i=()=>{const t=.0174533;let l,n,a=c-30*t,s=1e7;for(let i=0;i<60;i++){let r=e,y=o;for(;!h[8*Math.floor(y/64)+Math.floor(r/64)];)r+=Math.cos(a),y+=Math.sin(a);l=r,n=y,s=f(e,o,l,n);d(e+4,o+4,r,y);let P=c-a;P<0&&(P+=2*Math.PI),P>2*Math.PI&&(P-=2*Math.PI),s*=Math.cos(P);let g=20480/s;g>320&&(g=320);M(8*i+530,g,160-g/2),a+=t}},M=(e,o,l)=>{const n=t.getContext("2d");n.fillStyle="red",n.fillRect(e,160+l,8,o)},d=(e,o,l,n)=>{const c=t.getContext("2d");c.beginPath(),c.moveTo(e,o),c.lineTo(l,n),c.strokeStyle="#00ff00",c.stroke()},r=(t,e)=>{a.fillStyle="yellow",a.fillRect(t,e,8,8)};(()=>{let f=0,M=0,d=0,y=0;document.addEventListener("keydown",(t=>{"KeyW"===t.code&&(f=1),"KeyS"===t.code&&(d=1),"KeyA"===t.code&&(M=1),"KeyD"===t.code&&(y=1)})),document.addEventListener("keyup",(t=>{"KeyW"===t.code&&(f=0),"KeyS"===t.code&&(d=0),"KeyA"===t.code&&(M=0),"KeyD"===t.code&&(y=0)}));const P=()=>{a.clearRect(0,0,t.width,t.height),s();let g=e,m=o;l=2*Math.cos(c),n=2*Math.sin(c),1===f&&(g+=l,m+=n),1===d&&(g-=l,m-=n),1===M&&(c-=.05,c<0&&(c+=2*Math.PI),l=5*Math.cos(c),n=5*Math.sin(c)),1===y&&(c+=.05,c>2*Math.PI&&(c-=2*Math.PI),l=5*Math.cos(c),n=5*Math.sin(c));let K=8;K=l<0?-3:8;let I=8;I=n<0?-3:8;let S=8;S=l>0?0:-8;let u=8;u=n>0?0:-8;const T=Math.floor((g+K)/64),v=Math.floor((m+I)/64),k=Math.floor((g-S)/64),w=Math.floor((m-u)/64),x=Math.floor(g/64),C=Math.floor(m/64);1===f&&(0===h[8*C+T]&&(e=g),0===h[8*v+x]&&(o=m)),1===d&&(0===h[8*C+k]&&(e=g),0===h[8*w+x]&&(o=m)),r(e,o),i(),requestAnimationFrame(P)};P()})(),i()})()})()})();