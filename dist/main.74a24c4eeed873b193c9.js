(()=>{"use strict";(()=>{const t=document.getElementById("canvas");let e=300,o=300,l=0,n=0,c=0;const a=64,f=[1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,1,0,1,0,0,0,0,1,1,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1],h=()=>{for(let e=0;e<8;e++)for(let o=0;o<8;o++){const l=t.getContext("2d");l.fillStyle=1===f[8*o+e]?"#ffffff":"#000000";const n=e*a,c=o*a,h=n+a,s=c,i=n+a,M=c+a,r=n,d=c+a;l.beginPath(),l.moveTo(n+1,c+1),l.lineTo(h-1,s+1),l.lineTo(i-1,M-1),l.lineTo(r+1,d-1),l.closePath(),l.fill()}},s=(t,e,o,l)=>Math.sqrt((o-t)**2+(l-e)**2);h(),(()=>{const a=t.getContext("2d");a.fillStyle="yellow",a.fillRect(e,o,8,8);const i=()=>{const t=.0174533;let l,n,a=c-30*t,h=1e7;for(let i=0;i<60;i++){let d=e,y=o;for(;!f[8*Math.floor(y/64)+Math.floor(d/64)];)d+=Math.cos(a),y+=Math.sin(a);l=d,n=y,h=s(e,o,l,n);r(e+4,o+4,d,y);let P=c-a;P<0&&(P+=2*Math.PI),P>2*Math.PI&&(P-=2*Math.PI),h*=Math.cos(P);let g=20480/h;g>320&&(g=320);M(8*i+530,g,160-g/2),a+=t}},M=(e,o,l)=>{const n=t.getContext("2d");n.fillStyle="red",n.fillRect(e,160+l,8,o)},r=(e,o,l,n)=>{const c=t.getContext("2d");c.beginPath(),c.moveTo(e,o),c.lineTo(l,n),c.strokeStyle="#00ff00",c.stroke()},d=(t,e)=>{a.fillStyle="yellow",a.fillRect(t,e,8,8)};document.addEventListener("keydown",(s=>{let M=e,r=o;a.clearRect(0,0,t.width,t.height),h(),"KeyW"===s.code&&(M+=l,r+=n),"KeyS"===s.code&&(M-=l,r-=n),"KeyA"===s.code&&(c-=.1,c<0&&(c+=2*Math.PI),l=5*Math.cos(c),n=5*Math.sin(c)),"KeyD"===s.code&&(c+=.1,c>2*Math.PI&&(c-=2*Math.PI),l=5*Math.cos(c),n=5*Math.sin(c));const y=Math.floor((M+8)/64),P=Math.floor((r+8)/64),g=Math.floor(M/64),I=Math.floor(r/64);0===f[8*I+g]&&0===f[8*P+y]&&(e=M,o=r),d(e,o),i()})),i()})()})()})();